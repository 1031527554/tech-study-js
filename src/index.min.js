function e(){try{const e=JSON.parse(GM_getValue("studySetting"));if(e&&e.length===ge.length)return void(ue.settings=e)}catch(e){}ue.settings=ge}function t(){const e=z("div",void 0,{class:"egg_tip_wrap"});document.body.append(e)}function n(){if(T()){const e=$("meta[name=viewport]")[0];e&&(e.content="initial-scale=0, user-scalable=yes");const t=~~(window.innerWidth/window.outerWidth)||1;document.documentElement.style.setProperty("--scale",String(t))}}function i(){ue.settings[x.SAME_TAB]&&window.addEventListener("message",(e=>{const{data:t}=e;t.id&&(ue.id=t.id,I(`初始化窗口 ID: ${ue.id}`))}))}function a(){const e=$(".title")[0];e&&e.parentNode?.insertBefore(z("button",void 0,{class:ie(ue.examPause,(()=>"egg_exam_btn"+(ue.examPause.value?" manual":""))),type:"button",onclick:()=>{ue.examPause.value=!ue.examPause.value}},j(ie(ue.examPause,(()=>ue.examPause.value?"开启自动答题":"关闭自动答题")))),e.nextSibling)}async function s(){be("开始学习!"),await M(),ue.tasks.length&&(ue.settings[x.READ]&&!ue.tasks[y.READ].status&&(I("任务一: 文章选读"),be("任务一: 文章选读"),await M(),await je()),I("任务一: 文章选读已完成!"),ue.settings[x.WATCH]&&!ue.tasks[y.WATCH].status&&(I("任务二: 视听学习"),be("任务二: 视听学习"),await M(),await $e()),I("任务二: 视听学习已完成!"),ue.settings[x.PRACTICE]&&!ue.tasks[y.PRACTICE].status&&(I("任务三: 每日答题"),be("任务三: 每日答题"),await M(),await Fe()),I("任务三: 每日答题已完成!"),ue.settings[x.PAPER]&&!ue.tasks[y.PAPER].status&&(I("任务四: 专项练习"),be("任务四: 专项练习"),await M(),await Xe()),I("任务四: 专项练习已完成!"))}function o(){!0!==GM_getValue("pauseStudy")&&GM_setValue("pauseStudy",!0);const e=$(".egg_study_btn")[0];e.removeEventListener("click",o),e.addEventListener("click",r),ue.progress.value=k.PAUSE}function r(){!1!==GM_getValue("pauseStudy")&&GM_setValue("pauseStudy",!1);const e=$(".egg_study_btn")[0];e.removeEventListener("click",r),e.removeEventListener("click",l),e.addEventListener("click",o),ue.progress.value=k.START}function c(){ue.progress.value=k.FINISH}async function l(){if(be("准备开始学习"),I("准备开始学习..."),ue.login&&ue.progress.value!==k.START){if(r(),await s(),await Pe(),await Le(),c(),ue.settings[x.SAME_TAB]&&(xe(),ue.frameExist.value=!1),I("已完成"),be("完成学习!"),ue.settings[x.REMOTE_PUSH]){const{todayScore:e,totalScore:t}=ue;be(`学习推送${await L({title:"学习推送",content:["学习强国, 学习完成!",`当天积分:  ${R(e.value)} 分`,`总积分: ${R(t.value)} 分`,...ue.tasks.map((e=>C(e.title,e.percent.value)))],type:"success"},ue.pushToken)?"成功":"失败"}!`)}if(ue.settings[x.SCHEDULE_RUN]){const e=be("即将退出登录",5);await e.waitCountDown();const t=$("a[class='logged-link']")[0];t&&t.click()}}}GM_addStyle("* {  -webkit-tap-highlight-color: transparent;}:root {  --themeColor: #fa3333;  --scale: 1;  font-size: calc(10px * var(--scale));}@media (min-height: 678px) and (max-height: 768px) {  :root {    --scale: 0.8;  }}@media (max-height: 667px) {  :root {    --scale: 0.75;  }}@keyframes fade {  from {    opacity: 0.8;  }  to {    opacity: 0.4;    background: #ccc;  }}.egg_icon {  width: 1em;  height: 1em;  fill: currentColor;}.egg_hr_wrap {  position: relative;  display: flex;  justify-content: center;  color: #ccc;}.egg_hr_wrap .egg_hr {  position: absolute;  top: 50%;  transform: translateY(-50%);  background: currentColor;  height: 0.1rem;  width: 30%;}.egg_hr_wrap .egg_hr:nth-of-type(1) {  left: 0;}.egg_hr_wrap .egg_hr:nth-last-of-type(1) {  right: 0;}.egg_hr_title {  font-size: 1.2rem;}.egg_exam_btn {  transition: background-color 80ms;  outline: none;  border: none;  padding: 1.2rem 2rem;  border-radius: 1.2rem;  cursor: pointer;  font-size: 1.8rem;  font-weight: bold;  text-align: center;  color: #ffffff;  background: #666777;}.egg_exam_btn.manual {  background: #e3484b;}.egg_panel {  position: fixed;  top: 5rem;  left: 1rem;  padding: 1.2rem 2rem;  border-radius: 1rem;  background: #ffffffe6;  backdrop-filter: blur(1rem);  box-shadow: 0 0 0.1rem 0.1rem #f1f1f1;  transition: 80ms ease-out;  z-index: 99999;  color: #333;}.egg_panel.hide {  left: 0;  transform: translateX(-100%);}.egg_panel_wrap.mobile .egg_panel {  top: 1rem;}@media (min-height: 678px) and (max-height: 768px) {  .egg_panel {    top: 2rem;  }}@media (max-height: 667px) {  .egg_panel {    top: 1rem;  }}.egg_panel button {  outline: none;  border: none;  padding: 0;  cursor: pointer;  background: none;}.egg_panel .egg_btns_wrap {  position: absolute;  left: 100%;  top: 50%;  transform: translate(-50%, -50%);  transition: 80ms ease;  z-index: 9;}.egg_panel.hide .egg_btns_wrap {  left: 100%;  transform: translate(0, -50%);}.egg_panel .egg_btns_wrap button {  border-radius: 50%;  width: 3rem;  height: 3rem;  padding: 0;  overflow: hidden;  border: 0.2rem solid currentColor;  color: white;  display: grid;  place-items: center;  font-size: 1.8rem;}.egg_panel.hide .egg_setting_show_btn {  background: var(--themeColor);}.egg_panel .egg_setting_show_btn {  background: #ccc;}.egg_panel .egg_frame_show_btn {  background: var(--themeColor);  margin-bottom: 1rem;}.egg_panel .egg_frame_show_btn.hide {  display: none;}.egg_panel .egg_setting_push_btn {  background: #ccc;  margin-top: 1rem;}.egg_panel .egg_setting_push_btn.hide {  display: none;}.egg_panel .egg_setting_push_btn.active {  background: var(--themeColor);}.egg_login_wrap .egg_login_btn,.egg_user_wrap .egg_login_btn {  font-size: 1.4rem;  border-radius: 1rem;  transition: 80ms ease;  color: white;}.egg_login_wrap .egg_login_btn:active,.egg_user_wrap .egg_login_btn:active {  opacity: 0.8;}.egg_login_wrap .egg_login_btn {  background: var(--themeColor);  padding: 0.8rem 2.4rem;}.egg_user_wrap .egg_login_btn {  background: #ccc;  padding: 0.4rem 0.8rem;}.egg_login_wrap {  display: flex;  justify-content: center;  align-items: center;  flex-direction: column;  padding: 0.5rem 0;}.egg_login_wrap .egg_login_img_wrap {  height: 0;  border-radius: 1rem;  transition: height 80ms ease;  overflow: hidden;}.egg_login_wrap .egg_login_img_wrap.active {  padding: 0.8rem;  margin-top: 0.8rem;  height: auto;  background: white;}.egg_login_img_wrap .egg_login_img {  width: 15rem;  height: 15rem;}.egg_user_wrap {  display: flex;  justify-content: space-between;  align-items: center;}.egg_user_wrap .egg_userinfo {  display: flex;  justify-content: center;  align-items: center;  padding: 0.5rem 0;}.egg_userinfo .egg_avatar .egg_sub_nickname,.egg_userinfo .egg_avatar .egg_avatar_img {  height: 5rem;  width: 5rem;  border-radius: 50%;  background: var(--themeColor);  display: flex;  justify-content: center;  align-items: center;  text-overflow: ellipsis;  overflow: hidden;  white-space: nowrap;  font-size: 2rem;  color: white;}.egg_userinfo .egg_nick {  padding-left: 0.5rem;  text-overflow: ellipsis;  overflow: hidden;  white-space: nowrap;  max-width: 10rem;  font-size: 1.6rem;}.egg_score_item .egg_scoreinfo {  display: flex;  justify-content: space-between;  align-items: center;  padding: 0.5rem 0;}.egg_scoreinfo .egg_totalscore,.egg_scoreinfo .egg_todayscore {  font-size: 1.2rem;  user-select: none;}.egg_scoreinfo .egg_totalscore span,.egg_scoreinfo .egg_todayscore .egg_todayscore_btn span {  padding-left: 0.2rem;}.egg_scoreinfo .egg_totalscore span,.egg_todayscore .egg_todayscore_btn span,.egg_todayscore .egg_score_details span {  color: var(--themeColor);  font-weight: bold;}.egg_scoreinfo .egg_todayscore {  position: relative;}.egg_todayscore .egg_todayscore_btn {  display: flex;  align-items: center;}.egg_todayscore_btn .egg_icon {  opacity: 0.3;}.egg_todayscore .egg_score_details {  position: absolute;  left: calc(100% + 1rem);  top: 0;  background: #fffffff2;  border-radius: 0.5rem;  opacity: 1;  width: 10rem;  box-shadow: 0 0 0.1rem 0.1rem #f1f1f1;  transition: 80ms ease;  z-index: 9;}.egg_todayscore .egg_score_details.hide {  visibility: hidden;  opacity: 0;  left: 100%;}.egg_score_details .egg_score_title {  border-bottom: 0.1rem solid #eee;  padding: 0.5rem 0.8rem;  display: flex;  align-items: center;}.egg_score_details .egg_score_title .egg_icon {  font-size: 1.4rem;}.egg_score_details .egg_score_title .egg_score_title_text {  font-weight: bold;  padding-left: 0.2rem;}.egg_score_details .egg_score_item {  display: flex;  align-items: center;  justify-content: space-between;  padding: 0.5rem 0.8rem;}.egg_setting_item {  min-height: 3rem;  min-width: 18rem;  font-size: 1.6rem;  display: flex;  align-items: center;  justify-content: space-between;}.egg_setting_item .egg_label_wrap {  flex-grow: 1;}.egg_label_wrap .egg_progress {  display: flex;  justify-content: space-between;  align-items: center;  padding: 0.5rem 0;}.egg_progress .egg_track {  background: #ccc;  height: 0.5rem;  border-radius: 1rem;  flex: 1 1 auto;  overflow: hidden;}.egg_progress .egg_track .egg_bar {  height: 0.5rem;  background: var(--themeColor);  border-radius: 1rem;  width: 0;  transition: width 0.5s;}.egg_progress .egg_percent {  font-size: 1.2rem;  padding-left: 0.5rem;  width: 4rem;}.egg_detail {  background: #ccc;  color: white;  border-radius: 10rem;  font-size: 1.2rem;  width: 1.6rem;  height: 1.6rem;  margin-left: 0.4rem;  display: inline-block;  text-align: center;  line-height: 1.6rem;  cursor: pointer;}.egg_switch {  cursor: pointer;  margin: 0;  outline: 0;  appearance: none;  -webkit-appearance: none;  -moz-appearance: none;  position: relative;  width: 4.2rem;  height: 2.2rem;  background: #ccc;  border-radius: 5rem;  transition: background 0.3s;  --border-padding: 0.5rem;  box-shadow: -0.1rem 0 0.1rem -0.1rem #999 inset,    0.1rem 0 0.1rem -0.1rem #999 inset;}.egg_switch::after {  content: '';  display: inline-block;  width: 1.4rem;  height: 1.4rem;  border-radius: 50%;  background: #fff;  box-shadow: 0 0 0.2rem #999;  transition: left 0.4s;  position: absolute;  top: calc(50% - (1.4rem / 2));  position: absolute;  left: var(--border-padding);}.egg_switch:checked {  background: var(--themeColor);}.egg_switch:checked::after {  left: calc(100% - var(--border-padding) - 1.4rem);}.egg_study_item {  display: flex;  justify-content: center;  padding-top: 0.5rem;}.egg_study_item .egg_study_btn {  background: var(--themeColor);  padding: 0.8rem 2.4rem;  font-size: 1.4rem;  border-radius: 1rem;  color: white;  transition: 80ms ease;}.egg_study_item .egg_study_btn:not(.loading, .disabled):active {  opacity: 0.8;}.egg_study_item .egg_study_btn.loading {  animation: fade 2s ease infinite alternate;}.egg_study_item .egg_study_btn.disabled {  background: #ccc;}.egg_tip_wrap {  position: fixed;  left: 0;  top: 0;  z-index: 999999;  width: 100%;  height: 100%;  pointer-events: none;}.egg_tip_wrap .egg_tip {  position: absolute;  bottom: 2rem;  left: 2rem;  padding: 1.2rem 1.4rem;  border: none;  border-radius: 1rem;  background: var(--themeColor);  color: white;  font-size: 1.4rem;  transition: 200ms ease;  opacity: 0;  transform: scale(0.9) translateY(1rem);}.egg_tip_wrap .egg_tip.active {  opacity: 1;  transform: scale(1) translateY(0);}.egg_tip_wrap .egg_tip .egg_countdown {  display: inline-block;  color: var(--themeColor);  background: white;  border-radius: 0.5rem;  padding: 0.2rem 0.4rem;  font-weight: bold;  margin-left: 0.4rem;  font-size: 1.2rem;}.egg_frame_wrap {  position: fixed;  left: 0;  top: 0;  z-index: 999;  width: 100%;  height: 100%;  visibility: visible;}.egg_frame_wrap.hide {  visibility: hidden;}.egg_frame_wrap.hide .egg_frame_mask,.egg_frame_wrap.hide .egg_frame_content_wrap {  opacity: 0;}.egg_frame_wrap.hide .egg_frame_content_wrap {  transform: scale(0);}.egg_frame_mask {  background: #00000030;  width: 100%;  height: 100%;  opacity: 1;  transition: 200ms ease;}.egg_frame_content_wrap {  position: absolute;  width: 80%;  height: 80%;  top: 10%;  left: 10%;  display: flex;  flex-direction: column;  transition: 200ms ease;  border-radius: 1rem;  background: #ffffffe6;  backdrop-filter: blur(1rem);  overflow: hidden;  transform: scale(1);}.egg_frame_content_wrap.max {  top: 0;  left: 0;  width: 100%;  height: 100%;  border-radius: 0;}.egg_frame_content_wrap .egg_frame_controls_wrap {  width: 100%;  display: flex;  justify-content: space-between;  align-items: center;  box-sizing: border-box;}.egg_frame_controls_wrap .egg_frame_title {  padding: 1rem 2rem;  font-size: 1.6rem;}.egg_frame_controls .egg_frame_btn {  outline: none;  border: none;  background: none;  padding: 1rem 2rem;  transition: 80ms ease;  cursor: pointer;  color: #333;  font-size: 1.8rem;}.egg_frame_controls .egg_frame_btn:active {  opacity: 0.8;}.egg_frame_wrap .egg_frame_content {  width: 100%;  flex-grow: 1;  border-top: 0.1rem solid #ccc;  min-height: 40rem;  min-width: 30rem;  background: white;}.egg_frame_content .egg_frame {  width: 100%;  height: 100%;  outline: none;  border: none;}.egg_time_input {  display: inline-flex;  align-items: center;  justify-content: center;}.egg_time_input input {  outline: none;  border: 0.1rem solid #eee;  width: 2rem;  padding: 0.8rem;  text-align: center;  background: white;  border-radius: 0.2rem;}.egg_time_input input::placeholder {  color: #ccc;}.egg_time_input span {  padding: 0 0.5rem;  font-size: 1.5rem;}.egg_list {  max-height: 12rem;  overflow: auto;  border-radius: 0 0 0.2rem 0.2rem;  box-shadow: 0.1rem 0.1rem 0.1rem 0.1rem #eee;  position: absolute;  background: white;  z-index: 9;  scroll-behavior: smooth;  user-select: none;  transition: 100ms ease;  opacity: 1;  scrollbar-width: thin;}.egg_list.hide {  opacity: 0;  visibility: hidden;}.egg_list::-webkit-scrollbar {  width: 0.4rem;  background: white;  border-radius: 0.2rem;}.egg_list::-webkit-scrollbar-thumb {  background: #ccc;  border-radius: 0.2rem;}.egg_list .egg_time {  padding: 0.6rem 1rem;  border-bottom: 0.1rem solid #eee;  cursor: pointer;  color: #333;  transition: 100ms ease;}.egg_list .egg_time.focus {  font-weight: bold;  background: #eee;}.egg_list .egg_time:hover {  background: #eee;}.egg_schedule {  display: inline-flex;  flex-direction: column;  font-size: 1.4rem;  background: white;  border-radius: 1rem;  overflow: hidden;}.egg_schedule .egg_schedule_label {  padding: 1rem 0;  user-select: none;}.egg_schedule .egg_schedule_token_wrap {  padding: 1.5rem 2rem 0 2rem;}.egg_schedule_token_wrap .egg_schedule_token_input {  outline: none;  border: 0.1rem solid #eee;  padding: 1rem;  background: white;  border-radius: 0.2rem;  width: 100%;  box-sizing: border-box;  color: #ccc;}.egg_schedule_token_wrap .egg_schedule_token_input.active {  color: #333;}.egg_schedule_token_input::placeholder {  color: #ccc;}.egg_schedule .egg_schedule_submit_btn_wrap {  text-align: right;  padding-top: 1rem;  display: none;}.egg_schedule .egg_schedule_submit_btn_wrap.active {  display: block;}.egg_schedule_submit_btn_wrap .egg_schedule_submit_btn {  outline: none;  border: 0.1rem solid #eee;  padding: 0.5rem 1rem;  text-align: center;  background: white;  border-radius: 0.2rem;  cursor: pointer;}.egg_schedule_submit_btn_wrap .egg_schedule_submit_btn:active {  background: #eee;}.egg_schedule_add {  height: 100%;  display: flex;  flex-direction: column;}.egg_schedule_time_wrap {  padding: 1.5rem 2rem;  border-bottom: 0.1rem solid #eee;}.egg_schedule_time_input_wrap {  display: flex;  justify-content: space-between;  align-items: center;}.egg_schedule_time_input_wrap .egg_schedule_add_btn {  outline: none;  border: 0.1rem solid #eee;  padding: 0.5rem 1rem;  text-align: center;  background: white;  border-radius: 0.2rem;  cursor: pointer;}.egg_schedule_time_input_wrap .egg_schedule_add_btn:active {  background: #eee;}.egg_schedule_list {  height: 100%;  overflow: auto;}.egg_schedule_list .egg_schedule_item {  display: flex;  justify-content: space-between;  padding: 0.5rem 1.5rem;  font-size: 1.4rem;  border-bottom: 0.1rem solid #eee;}.egg_schedule_list::-webkit-scrollbar {  width: 0.4rem;  background: white;  border-radius: 0.2rem;}.egg_schedule_list::-webkit-scrollbar-thumb {  background: #ccc;  border-radius: 0.2rem;}.egg_schedule_detail_time_wrap {  display: flex;  align-items: center;}.egg_schedule_detail_time_wrap.inactive {  color: #ccc;}.egg_schedule_detail_time_wrap .egg_schedule_detail_icon {  padding-right: 0.4rem;  display: flex;  color: #ccc;}.egg_schedule_detail_del_wrap .egg_schedule_del_btn {  outline: none;  padding: 1rem;  text-align: center;  background: white;  border-radius: 0.2rem;  font-size: 1.4rem;  cursor: pointer;  color: #ccc;}.egg_schedule_detail_del_wrap .egg_schedule_del_btn:hover {  color: #333;}.egg_schedule_detail_del_wrap .egg_schedule_del_btn:active {  color: #eee;}.egg_schedule_list .egg_schedule_list_none {  width: 100%;  height: 100%;  display: flex;  flex-direction: column;  justify-content: center;  align-items: center;  color: #ccc;}.egg_schedule_list_none .egg_icon {  font-size: 2.5rem;}.egg_schedule_list_none_text {  padding-top: 1rem;}.egg_schedule_settings_item {  position: absolute;  top: 0;  left: 0;  width: 100%;  height: 100%;  pointer-events: none;  overflow: hidden;  border-radius: 1rem;}.egg_schedule_settings_item .egg_schedule {  width: 100%;  height: 100%;  pointer-events: all;  transform: translateX(100%);  transition: 300ms ease;}.egg_schedule_settings_item .egg_schedule.active {  transform: translateX(0);}"),window.addEventListener("load",(async()=>{const{href:s}=ue;if(u.home.test(s))return console.log(`%c tech-study.js %c ${d} `,"background:dodgerblue;color:white;font-size:15px;border-radius:4px 0 0 4px;padding:2px 0;","background:black;color:gold;font-size:15px;border-radius:0 4px 4px 0;padding:2px 0;"),I("进入主页面!"),e(),n(),t(),function(){if(ue.settings[x.REMOTE_PUSH])try{const e=GM_getValue("pushToken");e&&(ue.pushToken=e)}catch(e){ue.pushToken=""}}(),function(){if(ue.settings[x.SCHEDULE_RUN]){try{const e=JSON.parse(GM_getValue("scheduleList"));e&&(ue.scheduleList=e)}catch(e){ue.scheduleList=[]}Te()}}(),async function(){const e=function({login:e}){const t=ue.tasks.map((e=>({title:e.title,tip:e.tip,type:e.type}))),n=[{title:"自动开始",tip:"启动时, 自动开始任务, 在倒计时结束前自动开始可随时取消; 如果在自动开始前手动开始任务, 此次自动开始将取消",type:x.AUTO_START},{title:"同屏任务",tip:"运行任务时，所有任务均在当前页面以弹窗方式运行",type:x.SAME_TAB},{title:"静默运行",tip:"同屏任务时, 不显示任务弹窗静默运行",type:x.SILENT_RUN},{title:"定时刷新",tip:"定时刷新页面，重新进行任务，此功能需要长时间占用浏览器",type:x.SCHEDULE_RUN}],i=[{title:"随机作答",tip:"无答案时, 随机选择或者填入答案, 不保证正确!",type:x.RANDOM_EXAM}],a=[{title:"远程推送",tip:"利用 pushplus 推送, 将登录二维码直接推送到微信公众号",type:x.REMOTE_PUSH,handler(){}}],s=(e,t,n)=>{const{checked:i}=e.target;ue.settings[t]!==i&&(ue.settings[t]=i,GM_setValue("studySetting",JSON.stringify(ue.settings)),be(`${n} ${i?"打开":"关闭"}!`))},o=F(!1),r=F(!1);return z("div",void 0,{class:"egg_panel_wrap"+(T()?" mobile":"")},z("div",void 0,{class:ie(r,(()=>"egg_panel"+(r.value?" hide":"")))},[z("div",void 0,{class:"egg_user_item"},_e({login:e})),z("div",void 0,{class:"egg_score_item"},he({login:e})),pe({text:"任务"}),...t.map(((e,t)=>{const n=E(s,500);return function({title:e,tip:t,checked:n,onChange:i,percent:a}){return z("div",void 0,{class:"egg_setting_item"},[z("div",void 0,{class:"egg_label_wrap"},[z("label",void 0,{class:"egg_task_title"},j(e)),z("div",void 0,{class:"egg_progress"},[z("div",void 0,{class:"egg_track"},z("div",void 0,{class:"egg_bar",style:ie(a,(()=>`width: ${a.value}%;`))})),z("div",void 0,{class:"egg_percent"},[z("span",void 0,void 0,[j(a)]),j("%")])])]),z("input",void 0,{title:t,class:"egg_switch",type:"checkbox",checked:n,onChange:i})])}({title:e.title,tip:e.tip,checked:ue.settings[e.type],percent:ue.tasks[t].percent,onChange:t=>{n(t,e.type,e.title)}})})),pe({text:"运行"}),...n.map((e=>{const t=E(s,500);return we({title:e.title,tip:e.tip,checked:ue.settings[e.type],onChange:n=>{t(n,e.type,e.title)}})})),pe({text:"答题"}),...i.map((e=>{const t=E(s,500);return we({title:e.title,tip:e.tip,checked:ue.settings[e.type],onChange:n=>{t(n,e.type,e.title)}})})),pe({text:"推送"}),...a.map((e=>{const t=E(s,500);return we({title:e.title,tip:e.tip,checked:ue.settings[e.type],onChange:n=>{t(n,e.type,e.title)}})})),z("div",void 0,{class:"egg_btns_wrap"},[z("button",void 0,{class:ae([ue.frameShow,ue.frameExist],(()=>"egg_frame_show_btn"+(!ue.frameExist.value||ue.frameShow.value?" hide":""))),type:"button",onclick:()=>{ue.frameShow.value=!0}},N("svg",void 0,{viewBox:"0 0 1024 1024",class:"egg_icon"},N("path",void 0,{d:"M836.224 106.666667h-490.666667a85.589333 85.589333 0 0 0-85.333333 85.333333V256h-64a85.589333 85.589333 0 0 0-85.333333 85.333333v490.666667a85.589333 85.589333 0 0 0 85.333333 85.333333h490.666667a85.589333 85.589333 0 0 0 85.333333-85.333333V768h64a85.589333 85.589333 0 0 0 85.333333-85.333333V192a85.589333 85.589333 0 0 0-85.333333-85.333333z m-132.266667 725.333333a20.138667 20.138667 0 0 1-21.333333 21.333333h-490.666667a20.138667 20.138667 0 0 1-21.333333-21.333333V341.333333a20.138667 20.138667 0 0 1 21.333333-21.333333h494.933334a20.138667 20.138667 0 0 1 21.333333 21.333333v490.666667z m153.6-149.333333a20.138667 20.138667 0 0 1-21.333333 21.333333h-64V341.333333a85.589333 85.589333 0 0 0-85.333333-85.333333h-362.666667V192a20.138667 20.138667 0 0 1 21.333333-21.333333h490.666667a20.138667 20.138667 0 0 1 21.333333 21.333333z"}))),z("button",void 0,{class:"egg_setting_show_btn",type:"button",onclick:()=>{r.value=!r.value}},N("svg",void 0,{viewBox:"0 0 1024 1024",class:"egg_icon"},N("path",void 0,{d:"M332.16 883.84a40.96 40.96 0 0 0 58.24 0l338.56-343.04a40.96 40.96 0 0 0 0-58.24L390.4 140.16a40.96 40.96 0 0 0-58.24 58.24L640 512l-307.84 314.24a40.96 40.96 0 0 0 0 57.6z"}))),z("button",void 0,{class:ue.settings[x.REMOTE_PUSH]||ue.settings[x.SCHEDULE_RUN]?ie(o,(()=>"egg_setting_push_btn"+(o.value?" active":""))):"egg_setting_push_btn hide",type:"button",onclick:()=>{o.value=!o.value}},N("svg",void 0,{viewBox:"0 0 1024 1024",class:"egg_icon"},[N("path",void 0,{d:"M825.571556 176.355556c68.778667 0 124.472889 55.751111 124.472888 124.416v422.456888c0 68.721778-55.751111 124.416-124.472888 124.416H198.485333A124.416 124.416 0 0 1 73.955556 723.171556V300.828444C73.955556 232.106667 129.706667 176.355556 198.428444 176.355556zM893.155556 358.456889l-366.08 228.864a28.444444 28.444444 0 0 1-25.372445 2.389333l-4.778667-2.389333L130.844444 358.456889v364.771555c0 34.929778 26.567111 63.715556 60.643556 67.128889l6.883556 0.398223h627.2c37.319111 0 67.584-30.264889 67.584-67.584V358.513778zM825.571556 233.244444H198.485333c-34.304 0-62.577778 25.486222-67.015111 58.595556L512 529.635556l380.586667-237.795556A67.584 67.584 0 0 0 825.628444 233.244444z"})]))]),e?z("div",void 0,{class:"egg_study_item"},z("button",void 0,{class:ie(ue.progress,(()=>"egg_study_btn"+(ue.progress.value===k.LOADING||ue.progress.value===k.START?" loading":ue.progress.value===k.FINISH?" disabled":""))),type:"button",disabled:ie(ue.progress,(()=>ue.progress.value===k.LOADING||ue.progress.value===k.FINISH))},j(ie(ue.progress,(()=>""+(ue.progress.value===k.LOADING?"等待中":ue.progress.value===k.LOADED?"开始学习":ue.progress.value===k.START?"正在学习, 点击暂停":ue.progress.value===k.PAUSE?"继续学习":ue.progress.value===k.FINISH?"已完成":"")))))):void 0,z("div",void 0,{class:"egg_schedule_settings_item"},me({scheduleList:ue.scheduleList,show:o}))]))}({login:ue.login});if(document.body.append(e),ue.login){if(await Pe(),await Le(),ue.tasks.every(((e,t)=>!ue.settings[t]||e.status))){if(c(),I("已完成"),be("完成学习!"),ue.settings[x.REMOTE_PUSH]){const{todayScore:e,totalScore:t}=ue;be(`学习推送${await L({title:"学习推送",content:["学习强国, 学习完成!",`当天积分:  ${R(e.value)} 分`,`总积分: ${R(t.value)} 分`,...ue.tasks.map((e=>C(e.title,e.percent.value)))],type:"success"},ue.pushToken)?"成功":"失败"}!`)}if(ue.settings[x.SCHEDULE_RUN]){const e=be("即将退出登录",5);await e.waitCountDown();const t=$("a[class='logged-link']")[0];t&&t.click()}return}if(function(){!1!==GM_getValue("pauseStudy")&&GM_setValue("pauseStudy",!1);$(".egg_study_btn")[0].addEventListener("click",l),ue.progress.value=k.LOADED}(),ue.settings[x.AUTO_START]){const e=be("即将自动开始任务",5);await e.waitCountDown(),ue.settings[x.AUTO_START]&&ue.progress.value!==k.START?(be("自动开始任务"),l()):be("已取消自动开始任务!")}}}(),function(){if(ue.settings[x.SAME_TAB]){const e=function({show:e}){const t=F(!1);return z("div",void 0,{class:ie(e,(()=>"egg_frame_wrap"+(e.value?"":" hide")))},[z("div",void 0,{class:"egg_frame_mask"}),z("div",void 0,{class:ie(t,(()=>"egg_frame_content_wrap "+(t.value?" max":"")))},[z("div",void 0,{class:"egg_frame_controls_wrap"},[z("div",void 0,{class:"egg_frame_title"}),z("div",void 0,{class:"egg_frame_controls"},[z("button",void 0,{class:"egg_frame_btn",type:"button",onclick:()=>{ue.frameShow.value=!1}},N("svg",void 0,{viewBox:"0 0 1024 1024",class:"egg_icon"},N("path",void 0,{d:"M863.7 552.5H160.3c-10.6 0-19.2-8.6-19.2-19.2v-41.7c0-10.6 8.6-19.2 19.2-19.2h703.3c10.6 0 19.2 8.6 19.2 19.2v41.7c0 10.6-8.5 19.2-19.1 19.2z"}))),z("button",void 0,{class:"egg_frame_btn",type:"button",onclick:()=>{t.value=!t.value}},N("svg",void 0,{viewBox:"0 0 1024 1024",class:"egg_icon"},N("path",void 0,{d:"M609.52 584.92a35.309 35.309 0 0 1 24.98-10.36c9.37 0 18.36 3.73 24.98 10.36l189.29 189.22-0.07-114.3 0.57-6.35c3.25-17.98 19.7-30.5 37.9-28.85 18.2 1.65 32.12 16.92 32.09 35.2v200.23c-0.05 1.49-0.19 2.97-0.42 4.45l-0.21 1.13c-0.22 1.44-0.55 2.85-0.99 4.24l-0.57 1.62-0.56 1.41a34.163 34.163 0 0 1-7.62 11.36l2.12-2.4-0.14 0.14-0.92 1.06-1.06 1.2-0.57 0.57-0.56 0.57a36.378 36.378 0 0 1-16.23 8.39l-3.53 0.5-4.02 0.35h-199.6l-6.35-0.63c-16.73-3.06-28.9-17.63-28.93-34.64l0.56-6.35c3.07-16.76 17.67-28.93 34.71-28.92l114.29-0.14-189.07-189.1-4.09-4.94c-9.71-14.01-8.01-32.95 4.02-45.02z m-162.06 0c12.06 12.05 13.78 30.99 4.09 45.01l-4.09 4.94-189.15 189.08 114.3 0.14c17.04-0.01 31.65 12.17 34.71 28.92l0.57 6.35c-0.03 17.01-12.19 31.58-28.92 34.64l-6.35 0.63H173.09l-4.23-0.42-3.39-0.49a36.38 36.38 0 0 1-17.36-9.52l-1.06-1.13-0.98-1.13 0.98 1.06-1.97-2.26 0.85 1.06-0.42-0.56a35.137 35.137 0 0 1-3.74-5.64l-1.13-2.68a34.71 34.71 0 0 1-2.11-7.33l-0.28-1.13c-0.21-1.47-0.33-2.96-0.36-4.45V659.78c-0.03-18.28 13.89-33.55 32.09-35.2 18.2-1.65 34.65 10.87 37.9 28.85l0.57 6.35-0.07 114.36 189.29-189.22c13.77-13.77 36.11-13.77 49.88 0h-0.09z m-74.71-471.71l6.35 0.57c16.76 3.06 28.93 17.67 28.92 34.71l-0.63 6.35c-3.07 16.76-17.67 28.93-34.71 28.92l-114.3 0.14 189.15 189.08 4.09 4.94c10.26 15.02 7.42 35.37-6.55 47.01-13.98 11.63-34.51 10.74-47.42-2.07L208.29 233.71l0.07 114.3-0.57 6.35c-3.25 17.98-19.7 30.5-37.9 28.85-18.2-1.65-32.12-16.92-32.09-35.2V147.78c0-1.55 0.14-3.03 0.35-4.51l0.21-1.13c0.24-1.44 0.59-2.85 1.06-4.23a34.97 34.97 0 0 1 8.68-14.39l-2.12 2.4-0.42 0.57 1.55-1.84-0.99 1.06 0.92-0.98 2.26-2.33c3.04-2.73 6.52-4.92 10.3-6.49l2.82-1.06c3.45-1.07 7.04-1.62 10.65-1.62l-3.6 0.14h0.49l1.48-0.14h201.31z m512.91 0l1.41 0.14h0.42c2.43 0.29 4.84 0.79 7.19 1.48l2.82 1.06 2.61 1.2 3.04 1.76c2.09 1.33 4.03 2.89 5.78 4.66l1.13 1.2 0.78 0.98 0.21 0.14 0.49 0.64 2.33 3.17c2.35 3.83 3.98 8.07 4.8 12.49l0.21 1.13c0.21 1.48 0.35 2.96 0.35 4.44v200.37c-0.16 18.13-14.03 33.19-32.08 34.83-18.06 1.64-34.42-10.67-37.83-28.48l-0.57-6.35V233.65L659.54 422.87c-12.9 12.95-33.56 13.91-47.59 2.2-14.04-11.71-16.81-32.2-6.38-47.22l4.02-4.86 189.22-189.08-114.29-0.14c-17.06 0.04-31.71-12.14-34.78-28.92l-0.63-6.35c-0.01-17.04 12.16-31.65 28.93-34.71l6.35-0.57h201.27z m0 0"}))),z("button",void 0,{class:"egg_frame_btn",type:"button",onclick:()=>{xe()}},N("svg",void 0,{viewBox:"0 0 1024 1024",class:"egg_icon"},N("path",void 0,{d:"M453.44 512L161.472 220.032a41.408 41.408 0 0 1 58.56-58.56L512 453.44 803.968 161.472a41.408 41.408 0 0 1 58.56 58.56L570.56 512l291.968 291.968a41.408 41.408 0 0 1-58.56 58.56L512 570.56 220.032 862.528a41.408 41.408 0 0 1-58.56-58.56L453.44 512z"})))])]),z("div",void 0,{class:"egg_frame_content"},z("iframe",void 0,{class:"egg_frame"}))])])}({show:ue.frameShow});document.body.append(e)}}(),void async function(){ue.login||ue.settings[x.SCHEDULE_RUN]||(await U(".egg_login_img_wrap"),Re())}();if("string"==typeof GM_getValue("readingUrl")&&s===GM_getValue("readingUrl")){I("进入文章选读页面!"),e(),n(),i(),t();const a=(await U("section",void 0,5e3))[0];return a&&a.innerText.includes("系统正在维护中")?(I("未找到文章!"),void ke(ue.id)):void Ie(0)}if("string"==typeof GM_getValue("watchingUrl")&&s===GM_getValue("watchingUrl")){I("进入视听学习页面!"),e(),n(),i(),t();const a=(await U("video",void 0,1e4))[0],s=$(".prism-play-btn")[0];if(a&&s){a.muted=v,I("正在尝试播放视频...");const e=setTimeout((()=>{I("视频播放超时!"),ke(ue.id)}),2e4);return void a.addEventListener("canplay",(()=>{I("正在尝试播放视频..."),a.paused&&(a.play(),a.paused&&s.click()),a.paused||(clearTimeout(e),Ie(1))}))}return I("未找到视频!"),void ke(ue.id)}return s.includes(u.examPractice)?(I("进入每日答题页面!"),e(),n(),i(),t(),await U(".title"),a(),void qe(Ue.PRACTICE)):s.includes(u.examPaper)?(I("进入专项练习页面!"),e(),n(),i(),t(),await U(".title"),a(),void qe(Ue.PAPER)):void I("此页面不支持加载学习脚本!")}));const d="1.5.5",g={userInfo:"https://pc-api.xuexi.cn/open/api/user/info",totalScore:"https://pc-proxy-api.xuexi.cn/delegate/score/get",todayScore:"https://pc-proxy-api.xuexi.cn/delegate/score/today/query",taskList:"https://pc-proxy-api.xuexi.cn/api/score/days/listScoreProgress?sence=score&deviceType=2",todayNews:["https://www.xuexi.cn/lgdata/35il6fpn0ohq.json","https://www.xuexi.cn/lgdata/1ap1igfgdn2.json","https://www.xuexi.cn/lgdata/vdppiu92n1.json","https://www.xuexi.cn/lgdata/152mdtl3qn1.json"],todayVideos:["https://www.xuexi.cn/lgdata/525pi8vcj24p.json","https://www.xuexi.cn/lgdata/11vku6vt6rgom.json","https://www.xuexi.cn/lgdata/2qfjjjrprmdh.json","https://www.xuexi.cn/lgdata/3o3ufqgl8rsn.json","https://www.xuexi.cn/lgdata/591ht3bc22pi.json","https://www.xuexi.cn/lgdata/1742g60067k.json","https://www.xuexi.cn/lgdata/1novbsbi47k.json"],paperList:"https://pc-proxy-api.xuexi.cn/api/exam/service/paper/pc/list",answerSave:"https://a6.qikekeji.com/txt/data/save",answerSearch:"https://api.answer.redfish.top/answer/search",push:"https://www.pushplus.plus/send",generateQRCode:"https://login.xuexi.cn/user/qrcode/generate",loginWithQRCode:"https://login.xuexi.cn/login/login_with_qr",sign:"https://pc-api.xuexi.cn/open/api/sns/sign",secureCheck:"https://pc-api.xuexi.cn/login/secure_check",qrcode:"https://api.qrserver.com/v1/create-qr-code"},u={home:/^https\:\/\/www\.xuexi\.cn(\/(index\.html)?)?$/,homeOrigin:"https://www.xuexi.cn",examPractice:"https://pc.xuexi.cn/points/exam-practice.html",examPaper:"https://pc.xuexi.cn/points/exam-paper-detail.html"},p=6,_=6,h=10,f=1e5,v=!0;async function m(e){const t=`${g.paperList}?pageSize=50&pageNo=${e}`;try{const e=await fetch(t,{method:"GET",credentials:"include"});if(e.ok){const t=await e.json(),n=decodeURIComponent(escape(window.atob(t.data_str.replace(/-/g,"+").replace(/_/g,"/"))));return JSON.parse(n)}}catch(e){return[]}return[]}async function w(e){const t={question:e};try{const e=await fetch(g.answerSearch,{method:"POST",mode:"cors",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)});if(e.ok){const t=await e.json(),{errno:n}=t;if(-1!==n){const{answers:e}=t.data;return e}}}catch(e){}return[]}async function b(e,t){try{const n=JSON.stringify([{title:e,content:t}]),i=new URLSearchParams({txt_name:e,txt_content:n,password:"",v_id:""}),a=await fetch(g.answerSave,{method:"POST",mode:"cors",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:i.toString()});if(a.ok){return await a.json()}}catch(e){}}var y,x,k;function E(e,t){let n=-1;return function(...i){-1!==n&&clearTimeout(n),n=setTimeout((()=>{e.apply(this,i)}),t)}}function T(){let e=!1;return navigator.userAgent.match(/(phone|pad|pod|iPhone|iPod|ios|iPad|Android|Mobile|BlackBerry|IEMobile|MQQBrowser|JUC|Fennec|wOSBrowser|BrowserNG|WebOS|Symbian|Windows Phone)/i)&&(I("移动端"),e=!0),document.body.clientWidth<800&&(I("小尺寸设备端"),e=!0),e}function S(e){return Number.isInteger(e)||(e=1e3),new Promise((t=>{setTimeout((()=>{t("done")}),e)}))}function A(e){return new Promise((t=>{if((GM_getValue("pauseStudy")||!1)&&(ue.examPause.value=!0),ue.examPause.value){be("已暂停, 手动开启自动答题! ",10);const n=setInterval((()=>{if(!ue.examPause.value)return clearInterval(n),I("答题等待结束!"),e&&e instanceof Function&&(be("已开启, 自动答题!"),e(!0)),void t(!0);e&&e instanceof Function&&e(!1),I("答题等待...")}),500)}else t(!0)}))}function M(e){return new Promise((t=>{if(GM_getValue("pauseStudy")||!1){const n=setInterval((()=>{if(!(GM_getValue("pauseStudy")||!1))return clearInterval(n),I("学习等待结束!"),e&&e instanceof Function&&e("done"),void t("done");e&&e instanceof Function&&e("pending"),I("学习等待...")}),500)}else t("done")}))}function C(e,t){return`<div\n    style="\n      display: flex;\n      align-items: center;\n      justify-content: space-between;\n      padding: 1px 0;\n    "\n  >\n    <span>${e}</span>\n    <span>${R(t)} %</span>\n  </div>\n  <div\n    style="\n      background: white;\n      border-radius: 10px;\n      height: 10px;\n      border: 1px solid #eee;\n      flex-shrink: 1;\n    "\n  >\n    <div\n      style="\n        background: linear-gradient(to left, #188fff80, #1890ff);\n        height: 100%;\n        width: ${t}%;\n        border-radius: 10px;\n      "\n    ></div>\n  </div>`}function R(e){return`<span style="color: #1890ff">${e}</span>`}async function P(e){const{title:t,content:n,template:i,fromToken:a,toToken:s}=e,o=await async function(e,t,n,i,a){try{const s={token:e,title:t,content:n,template:i};a&&(s.to=a);const o=await fetch(g.push,{method:"POST",mode:"cors",headers:{"Content-Type":"application/json"},body:JSON.stringify(s)});if(o.ok)return await o.json()}catch(e){}}(a,t,n,i,s);return o}async function L(e,t,n){const i=function(e){const{title:t,subTitle:n="",to:i="用户",content:a,type:s,from:o="tech-study.js"}=e;let r="";r=Array.isArray(a)?a.map((e=>`<div>${e}</div>`)).join(""):a;const c=le();let l="";return s&&s.length&&("info"===s&&(l='\n      <svg\n       viewBox="64 64 896 896"\n       style="color: #1890ff; width: 18px; height: 18px"\n       fill="currentColor"\n       aria-hidden="true"\n     >\n       <path\n         d="M512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64zm-32 232c0-4.4 3.6-8 8-8h48c4.4 0 8 3.6 8 8v272c0 4.4-3.6 8-8 8h-48c-4.4 0-8-3.6-8-8V296zm32 440a48.01 48.01 0 010-96 48.01 48.01 0 010 96z"\n       ></path>\n     </svg>'),"warn"===s&&(l='\n      <svg\n        viewBox="64 64 896 896"\n        style="color: #faad14; width: 18px; height: 18px"\n        fill="currentColor"\n        aria-hidden="true"\n      >\n        <path\n          d="M512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64zm-32 232c0-4.4 3.6-8 8-8h48c4.4 0 8 3.6 8 8v272c0 4.4-3.6 8-8 8h-48c-4.4 0-8-3.6-8-8V296zm32 440a48.01 48.01 0 010-96 48.01 48.01 0 010 96z"\n        ></path>\n      </svg>\n      '),"success"===s&&(l='\n      <svg\n        viewBox="64 64 896 896"\n        style="color: #52c41a; width: 18px; height: 18px"\n        fill="currentColor"\n        aria-hidden="true"\n      >\n        <path\n          d="M512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64zm193.5 301.7l-210.6 292a31.8 31.8 0 01-51.7 0L318.5 484.9c-3.8-5.3 0-12.7 6.5-12.7h46.9c10.2 0 19.9 4.9 25.9 13.3l71.2 98.8 157.2-218c6-8.3 15.6-13.3 25.9-13.3H699c6.5 0 10.3 7.4 6.5 12.7z"\n        ></path>\n      </svg>\n      '),"fail"===s&&(l='\n      <svg\n        viewBox="64 64 896 896"\n        style="color: #ff4d4f; width: 18px; height: 18px"\n        fill="currentColor"\n        aria-hidden="true"\n      >\n        <path\n          d="M512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64zm165.4 618.2l-66-.3L512 563.4l-99.3 118.4-66.1.3c-4.4 0-8-3.5-8-8 0-1.9.7-3.7 1.9-5.2l130.1-155L340.5 359a8.32 8.32 0 01-1.9-5.2c0-4.4 3.6-8 8-8l66.1.3L512 464.6l99.3-118.4 66-.3c4.4 0 8 3.5 8 8 0 1.9-.7 3.7-1.9 5.2L553.5 514l130 155c1.2 1.5 1.9 3.3 1.9 5.2 0 4.4-3.6 8-8 8z"\n        ></path>\n      </svg>\n      ')),`\n  <div\n  style="\n    padding: 5px;\n    display: flex;\n    justify-content: center;\n    align-items: center;\n  "\n>\n  <div\n    style="\n      background: #ffffff;\n      box-shadow: 1px 1px 8px -1px #dadada;\n      padding: 5px 10px;\n      border-radius: 5px;\n      width: 100%;\n    "\n  >\n    <div\n      style="\n        display: flex;\n        justify-content: space-between;\n        padding: 5px;\n        border-bottom: 1px solid #eee;\n      "\n    >\n      <div style="display: flex; justify-content: center; align-items: center">\n        \n  <span\n    style="\n      padding-right: 5px;\n      display: flex;\n      justify-content: center;\n      align-items: center;\n    "\n  >\n    ${l}\n  </span>\n  \n        <span style="padding-left: 5px; font-size: 18px">${t}</span>\n      </div>\n      <div style="font-size: 16px; color: #999">${n}</div>\n    </div>\n    <div></div>\n\n    <div style="padding:10px 5px; font-size: 16px; min-height: 80px">\n      <div>\n        ${R(i)}, 你好!\n      </div>\n      <div style="line-height: 28px;">${r}</div>\n    </div>\n    <div\n      style="\n        font-size: 14px;\n        padding: 5px;\n        border-top: 1px solid #eee;\n        display: flex;\n        justify-content: space-between;\n        align-items: center;\n      "\n    >\n      <div style="color: #999">${c}</div>\n      <div>\n        <span>来自</span>\n        <span style="color: #1890ff; padding-left: 1px">${o}</span>\n      </div>\n    </div>\n  </div>\n</div>  \n  `}(e),a=await P({title:"消息提示",content:i,fromToken:t,toToken:n,template:"html"});if(a&&200===a.code)return a}function I(...e){console.log(`%c[${le()}] %c${e.join(" ")}`,"","color:dodgerblue")}function z(e,t,n,i){const a=document.createElement(e);for(const e in t)if(W(t[e])){const n=t[e];a[e]=n.value,ne((()=>a[e]=n.value))}else a[e]=t[e];for(const e in n){const t=n[e],i=["checked","selected","disabled","enabled"];if(e.toLowerCase().startsWith("on")){const[,n]=e.toLowerCase().split("on");if(n)if(W(t)){const e=t;if(t.value instanceof Function){a.addEventListener(n,e.value);const t=e.value;ne((()=>{a.removeEventListener(n,t),e.value instanceof Function&&a.addEventListener(n,e.value)}))}}else t instanceof Function&&a.addEventListener(n,t)}else if(i.includes(e))if(W(t)){const n=t;n.value?a.setAttribute(e,""):a.removeAttribute(e),ne((()=>{n.value?a.setAttribute(e,""):a.removeAttribute(e)}))}else t?a.setAttribute(e,""):a.removeAttribute(e);else if("ref"===e){if(W(t)){t.value=a}if(t instanceof Function){t(a)}}else if(W(t)){const n=t;a.setAttribute(e,n.value),ne((()=>{a.setAttribute(e,n.value)}))}else a.setAttribute(e,t)}if(i)if(i instanceof Array){const e=i.filter((e=>e));a.append(...e)}else i instanceof Promise?i.then((e=>e&&a.append(e))):a.append(i);return a}function N(e,t,n,i){const a=document.createElementNS("http://www.w3.org/2000/svg",e);for(const e in t)if(t[e]instanceof Object)for(const n in t[e])a[e][n]=t[e][n];else if(W(t[e])){const n=t[e];a[e]=n.value,ne((()=>{a[e]=n.value}))}else a[e]=t[e];for(const e in n){const t=n[e],s=e.toLowerCase(),o=["checked","selected","disabled","enabled"];if(s.startsWith("xlink:")){const n="http://www.w3.org/1999/xlink";t?a.setAttributeNS(n,e,t):a.removeAttributeNS(n,e)}else if(s.startsWith("on")){const[,n]=e.toLowerCase().split("on");if(n)if(W(t)){const e=t;if(e.value instanceof Function){a.addEventListener(n,e.value);const t=e.value;ne((()=>{a.removeEventListener(n,t),e.value instanceof Function&&a.addEventListener(n,e.value)}))}}else t instanceof Function&&a.addEventListener(n,t)}else if(o.includes(e))if(W(t)){const n=t;n.value?a.setAttribute(e,""):a.removeAttribute(e),ne((()=>{n.value?a.setAttribute(e,""):a.removeAttribute(e)}))}else if("ref"===e){if(W(t)){t.value=a}if(t instanceof Function){t(a)}}else t?a.setAttribute(e,""):a.removeAttribute(e);else if(W(t)){const n=t;a.setAttribute(e,n.value),ne((()=>{a.setAttribute(e,n.value)}))}else a.setAttribute(e,t);i&&(i instanceof Array?a.append(...i):a.append(i))}return a}function j(e){if(W(e)){const t=e,n=document.createTextNode(t.value);return ne((()=>{n.data=t.value})),n}return document.createTextNode(e)}function $(e,t=document){return Array.from(t.querySelectorAll(e))}function U(e,t=document,n){return new Promise((i=>{const a=setInterval((()=>{const n=Array.from(t.querySelectorAll(e));n.length&&(clearInterval(a),i(n))}),10);n&&setTimeout((()=>{clearInterval(a),i([])}),n)}))}!function(e){e[e.READ=0]="READ",e[e.WATCH=1]="WATCH",e[e.PRACTICE=2]="PRACTICE",e[e.PAPER=3]="PAPER"}(y||(y={})),function(e){e[e.READ=0]="READ",e[e.WATCH=1]="WATCH",e[e.PRACTICE=2]="PRACTICE",e[e.PAPER=3]="PAPER",e[e.AUTO_START=4]="AUTO_START",e[e.SAME_TAB=5]="SAME_TAB",e[e.SILENT_RUN=6]="SILENT_RUN",e[e.SCHEDULE_RUN=7]="SCHEDULE_RUN",e[e.RANDOM_EXAM=8]="RANDOM_EXAM",e[e.REMOTE_PUSH=9]="REMOTE_PUSH"}(x||(x={})),function(e){e[e.LOADING=0]="LOADING",e[e.LOADED=1]="LOADED",e[e.START=2]="START",e[e.PAUSE=3]="PAUSE",e[e.FINISH=4]="FINISH"}(k||(k={}));const H=new WeakMap;let D;const O=e=>{if(!D)return;let t=H.get(e);t||(t=new Set,H.set(e,t)),t.add(D)};function V(e,t,n){const i=H.get(e);if(i&&i)for(const e of i)e instanceof Function&&e(t,n)}var G;!function(e){e.IS_REF="_isRef",e.IS_SHALLOW="_isShallow",e.IS_REACTIVE="_isReactive",e.IS_READONLY="_isReadonly"}(G||(G={}));class B{_shallow=!1;_isRef=!0;_value;value;constructor(e,t=!1){const n=this;if(this._shallow=t,e instanceof Object&&t){const t=K(e);this._value=t,this.value=t}else this._value=e,this.value=e;Object.defineProperty(this,"value",{get(){return O(this),n._value},set(e){const t=this._value;t!==e&&(n._value=e,V(this,e,t))}})}}const W=e=>e&&e[G.IS_REF],q=e=>W(e)?e.value:e,F=e=>W(e)?e:new B(e,!1),X=(e,t)=>function(n,i,a){if(i===G.IS_REACTIVE)return!e;if(i===G.IS_READONLY)return e;const s=Reflect.get(n,i,a);return e||O(a),t?s:W(s)?s.value:s instanceof Object?e?ee(s):K(s):s},Y=e=>function(t,n,i,a){const s=t[n];if(Q(s)&&W(s)&&!W(i))return!1;if(!e&&W(s)&&!W(i))return s.value=i,!0;const o=Reflect.set(t,n,i,a);return s!==i&&V(a,i,s),o},J=(e,t,n)=>new Proxy(e,((e,t)=>({get:X(e,t),set:Y(t)}))(t,n)),Q=e=>e&&e[G.IS_READONLY],Z=e=>(e=>e&&e[G.IS_REACTIVE])(e)||Q(e),K=e=>(e=>J(e,!1,!0))(e),ee=e=>(e=>J(e,!0,!0))(e),te=(e,t)=>{let n=H.get(e);if(n||(n=new Set,H.set(e,n)),n.add(t),Z(e))for(const n in e){const i=e[n];Z(i)&&te(i,(()=>{t(e,e)}))}W(e)&&Z(e.value)&&te(e.value,(()=>{t(e,e)}))},ne=e=>{D=e,e(),D=void 0},ie=(e,t)=>{if(W(e)){const n=F(t(e.value));return ne((()=>n.value=t(e.value))),n}},ae=(e,t)=>{if(Array.isArray(e)){const n=F(t(e.map((e=>q(e)))));return e.forEach((i=>{te(i,(()=>n.value=t(e.map((e=>q(e))))))})),n}};function se(){return(~~(10*Math.random())).toString()}function oe(){return String.fromCharCode(65+~~(26*Math.random()))}function re(){return String.fromCharCode(97+~~(26*Math.random()))}function ce(e){return e<10?`0${e}`:`${e}`}function le(e=Date.now()){const t=new Date(e),n=t.getSeconds(),i=t.getMinutes(),a=t.getHours(),s=t.getDate(),o=t.getMonth()+1;return`${[t.getFullYear(),o,s].map(ce).join("-")} ${[a,i,n].map(ce).join(":")}`}function de({hour:e,minute:t}){const n=new Date,i=n.getHours(),a=n.getMinutes();return i>e||i===e&&a>=t}const ge=[!0,!0,!0,!0,!1,!1,!1,!1,!1,!1],ue={tasks:[{title:"文章选读",currentScore:0,dayMaxScore:0,need:0,status:!1,tip:"每有效阅读一篇文章积1分，上限6分。有效阅读文章累计1分钟积1分，上限6分。每日上限积12分。",type:y.READ,percent:F(0),score:F(0)},{title:"视听学习",currentScore:0,dayMaxScore:0,need:0,status:!1,tip:"每有效一个音频或观看一个视频积1分，上限6分。有效收听音频或观看视频累计1分钟积1分，上限6分。每日上限积12分。",type:y.WATCH,percent:F(0),score:F(0)},{title:"每日答题",currentScore:0,dayMaxScore:0,need:0,status:!1,tip:"每组答题每答对1道积1分。每日上限积5分。",type:y.PRACTICE,percent:F(0),score:F(0)},{title:"专项练习",currentScore:0,dayMaxScore:0,need:0,status:!1,tip:"每组答题每答对1道积1分，同组答题不重复积分；每日仅可获得一组答题积分，5道题一组的上限5分，10道题一组的上限10分。",type:y.PAPER,percent:F(0),score:F(0)}],totalScore:F(0),todayScore:F(0),href:window.location.href,settings:ge,progress:F(k.LOADING),examPause:F(!1),login:!!function(e){const t=document.cookie.split(";");for(const n in t){const i=t[n].split("=");if(i[0].trim()===e)return i[1].trim()}return null}("token"),news:[],videos:[],refreshTimer:null,scheduleTimer:null,closed:!0,id:"",scheduleList:[],pushToken:"",refreshCount:0,frameShow:F(!1),frameExist:F(!1),frameTile:F(""),startLogin:F(!1)};function pe({text:e}){return z("div",void 0,{class:"egg_hr_wrap"},[z("div",void 0,{class:"egg_hr"}),z("div",void 0,{class:"egg_hr_title"},j(e)),z("div",void 0,{class:"egg_hr"})])}async function _e({login:e}){if(e){const e=await async function(){try{const e=await fetch(g.userInfo,{method:"GET",credentials:"include"});if(e.ok){const{data:t}=await e.json();return t}}catch(e){}}();if(e){const{avatarMediaUrl:t,nick:n}=e;return z("div",void 0,{class:"egg_user_wrap"},[z("div",void 0,{class:"egg_userinfo"},[z("div",void 0,{class:"egg_avatar"},t?z("img",void 0,{src:t,class:"egg_avatar_img"}):z("div",void 0,{class:"egg_sub_nickname"},j(n.substring(1,3)))),z("div",void 0,{class:"egg_nick"},j(n))]),z("button",void 0,{type:"button",class:"egg_login_btn",onclick:E((()=>{const e=$("a[class='logged-link']")[0];e&&e.click()}),500)},j("退出"))])}}return z("div",void 0,{class:"egg_login_wrap"},[z("button",void 0,{type:"button",class:"egg_login_btn",onclick:E((async()=>{Re()}),500)},j("扫码登录")),z("div",void 0,{class:ie(ue.startLogin,(()=>"egg_login_img_wrap"+(ue.startLogin.value?" active":"")))},z("img",void 0,{class:"egg_login_img"}))])}function he({login:e}){if(e){const e=F(!1);return z("div",void 0,{class:"egg_scoreinfo"},[z("div",void 0,{class:"egg_totalscore"},[j("总积分"),z("span",void 0,void 0,j(ue.totalScore))]),z("div",void 0,{class:"egg_todayscore"},[z("button",void 0,{type:"button",class:"egg_todayscore_btn",title:"查看分数详情",onclick:()=>{e.value=!e.value},onblur:()=>{e.value=!1}},[j("当天分数"),z("span",void 0,void 0,j(ue.todayScore)),N("svg",void 0,{viewBox:"0 0 1024 1024",class:"egg_icon"},N("path",void 0,{d:"M332.16 883.84a40.96 40.96 0 0 0 58.24 0l338.56-343.04a40.96 40.96 0 0 0 0-58.24L390.4 140.16a40.96 40.96 0 0 0-58.24 58.24L640 512l-307.84 314.24a40.96 40.96 0 0 0 0 57.6z"})),z("div",void 0,{class:ie(e,(()=>"egg_score_details"+(e.value?"":" hide")))},[z("div",void 0,{class:"egg_score_title"},[N("svg",void 0,{viewBox:"0 0 1024 1024",class:"egg_icon"},[N("path",void 0,{d:"M314.81 304.01h415.86v58.91H314.81zM314.81 440.24h415.86v58.91H314.81z"}),N("path",void 0,{d:"M814.8 892.74h-8.64l-283.51-182-283.51 182h-8.64A69.85 69.85 0 0 1 160.72 823V188.22a69.85 69.85 0 0 1 69.77-69.77H814.8a69.85 69.85 0 0 1 69.77 69.77V823a69.85 69.85 0 0 1-69.77 69.74zM230.5 177.35a10.87 10.87 0 0 0-10.86 10.86V823a10.86 10.86 0 0 0 5 9.11l298.01-191.42 298.06 191.38a10.86 10.86 0 0 0 5-9.11V188.22a10.87 10.87 0 0 0-10.86-10.86z"})]),z("div",void 0,{class:"egg_score_title_text"},j("积分详情"))]),...ue.tasks.map((e=>z("div",void 0,{class:"egg_score_item"},[j(e.title),z("span",void 0,{class:"egg_score_detail"},j(e.score))])))])])])])}}function fe({hour:e,minute:t}){const n=new Array(24).fill(void 0).map(((e,t)=>({value:t,label:ce(t),active:F(!1),ele:F(null)}))),i=new Array(60).fill(void 0).map(((e,t)=>({value:t,label:ce(t),active:F(!1),ele:F(null)}))),a=F(!1),s=F(!1);return ne((()=>{const t=$(".egg_hour_wrap .egg_list")[0];if(t){const i=n.findIndex((t=>!(!e.value||!t.label.includes(String(e.value)))));n.forEach(((e,n)=>{i+1?(e.active.value=n===i,e.active.value&&(t.scrollTop=e.ele.value?.offsetTop||0)):(e.active.value=!1,t.scrollTop=0)}))}})),ne((()=>{const e=$(".egg_minute_wrap .egg_list")[0];if(e){const n=i.findIndex((e=>!(!t.value||!e.label.includes(String(t.value)))));i.forEach(((t,i)=>{n+1?(t.active.value=i===n,t.active.value&&(e.scrollTop=t.ele.value?.offsetTop||0)):(t.active.value=!1,e.scrollTop=0)}))}})),z("div",void 0,{class:"egg_time_input"},[z("div",void 0,{class:"egg_hour_wrap"},[z("input",void 0,{placeholder:"12",class:"egg_hour",type:"text",maxlength:"2",onfocus:()=>{a.value=!0},oninput:t=>{const n=t.target.value.trim();/^([0-9]|[01][0-9]|[2][0-3])$/.test(n)&&(e.value=Number(n))},onblur:t=>{const n=t.target,i=n.value.trim();e.value=/^([0-9]|[01][0-9]|[2][0-3])$/.test(i)?Number(i):-1,-1===e.value&&(n.value=""),setTimeout((()=>{a.value=!1}),100)}}),z("div",void 0,{class:ie(a,(()=>"egg_list"+(a.value?"":" hide")))},n.map((t=>z("div",void 0,{class:ie(t.active,(()=>"egg_time"+(t.active.value?" focus":""))),onclick:()=>{const n=$(".egg_hour")[0];e.value=t.value,n.value=t.label},ref:t.ele},j(t.label)))))]),z("span",void 0,void 0,j(":")),z("div",void 0,{class:"egg_minute_wrap"},[z("input",void 0,{placeholder:"00",class:"egg_minute",type:"text",maxlength:"2",onfocus:()=>{s.value=!0},oninput:e=>{const n=e.target.value.trim();/^([0-9]|[0-5][0-9])$/.test(n)&&(t.value=Number(n))},onblur:e=>{const n=e.target,i=n.value.trim();t.value=/^([0-9]|[0-5][0-9])$/.test(i)?Number(i):-1,-1===t.value&&(n.value=""),setTimeout((()=>{s.value=!1}),100)}}),z("div",void 0,{class:ie(s,(()=>"egg_list"+(s.value?"":" hide")))},i.map((e=>z("div",void 0,{class:ie(e.active,(()=>"egg_time"+(e.active.value?" focus":""))),onclick:()=>{const n=$(".egg_minute")[0];t.value=e.value,n.value=e.label},ref:e.ele},j(e.label)))))])])}function ve({scheduleList:e}){return z("div",void 0,{class:"egg_schedule_list"},e.length?e.map(((t,n)=>z("div",void 0,{class:"egg_schedule_item"},[z("div",void 0,{class:"egg_schedule_detail_time_wrap"+(de(t)?" inactive":"")},[z("div",void 0,{class:"egg_schedule_detail_icon"},N("svg",void 0,{viewBox:"0 0 1024 1024",class:"egg_icon"},[N("path",void 0,{d:"M810.137703 213.860762c-164.388001-164.4187-431.887404-164.4187-596.277452 0-164.417677 164.388001-164.417677 431.889451 0 596.278475 164.390048 164.417677 431.890474 164.417677 596.277452 0C974.557426 645.750213 974.557426 378.248763 810.137703 213.860762zM767.347131 767.345596c-140.797723 140.829446-369.927237 140.797723-510.693238 0-140.828422-140.797723-140.828422-369.895515 0-510.708588 140.767024-140.783397 369.896538-140.813073 510.693238 0C908.14383 397.420405 908.14383 626.578572 767.347131 767.345596z"}),N("path",void 0,{d:"M721.450824 521.495258 515.404028 521.495258l0.028653-227.948619c0-15.124466-12.362562-27.458375-27.501354-27.458375s-27.443026 12.33391-27.443026 27.458375l0 235.115855c0 0.835018-1.013073 20.48659 12.094456 34.459836 8.331759 8.809643 20.038382 13.288654 35.148521 13.288654l213.720569 0.031722c15.140839 0 27.472702-12.304234 27.472702-27.474748C748.922503 533.887496 736.620315 521.584286 721.450824 521.495258z"})])),z("div",void 0,{class:"egg_schedule_detail_time"},j(t.time))]),z("div",void 0,{class:"egg_schedule_detail_del_wrap"},[z("button",void 0,{class:"egg_schedule_del_btn",onclick:()=>{if(!ue.settings[x.SCHEDULE_RUN])return void be("未开启定时刷新!");const n=e.findIndex((e=>e===t));e.splice(n,1),GM_setValue("scheduleList",JSON.stringify(e));const i=$(".egg_schedule_list")[0],a=$(".egg_schedule_add")[0];i.remove(),a.append(ve({scheduleList:e})),Te()}},N("svg",void 0,{viewBox:"0 0 1024 1024",class:"egg_icon"},[N("path",void 0,{d:"M896.22 896.22c14.262-14.263 11.263-40.449-6.583-58.295L230.473 178.76c-17.847-17.847-44.105-20.846-58.295-6.583-14.263 14.19-11.264 40.448 6.583 58.295l659.164 659.164c17.846 17.846 44.032 20.845 58.294 6.582"}),N("path",void 0,{d:"M172.178 896.22c-14.263-14.263-11.264-40.449 6.583-58.295L837.925 178.76c17.846-17.847 44.032-20.846 58.294-6.583 14.263 14.19 11.264 40.448-6.582 58.295L230.4 889.637c-17.847 17.846-44.105 20.845-58.295 6.582"})]))])]))):z("div",void 0,{class:"egg_schedule_list_none"},[N("svg",void 0,{viewBox:"0 0 1024 1024",class:"egg_icon"},[N("path",void 0,{d:"M238.1 520.5c-17.6 0-31.9-14.3-31.9-31.9 0-17.6 14.3-31.9 31.9-31.9h293c17.6 0 31.9 14.3 31.9 31.9 0 17.6-14.3 31.9-31.9 31.9h-293zM238.1 733.6c-17.6 0-31.9-14.3-31.9-31.9s14.3-31.9 31.9-31.9h186.5c17.6 0 31.9 14.3 31.9 31.9s-14.3 31.9-31.9 31.9H238.1zM241.6 314.9c-17.6 0-31.9-14.3-31.9-31.9s14.3-31.9 31.9-31.9h426.1c17.6 0 31.9 14.3 31.9 31.9 0 17.5-14.3 31.7-31.8 31.9H241.6z"}),N("path",void 0,{d:"M160 926.6c-46.9 0-85.1-38.2-85.1-85.1V149.1c0-46.9 38.2-85.1 85.1-85.1h586c46.9 0 85.1 38.2 85.1 85.1v297.4c0 17.6-14.3 31.9-31.9 31.9-17.6 0-31.9-14.3-31.9-31.9V149.1c0-11.8-9.6-21.4-21.4-21.4H160c-11.8 0-21.4 9.6-21.4 21.4v692.4c0 11.8 9.6 21.4 21.4 21.4h304.5c17.5 0 31.8 14.2 31.9 31.8 0 17.6-14.3 31.8-31.9 31.8H160z"}),N("path",void 0,{d:"M917.2 959.9c-8.5 0-16.5-3.3-22.5-9.3l-78.5-78.5-5.3-0.5-0.6 0.4c-31.7 21.6-68.7 33-107 33-105.2 0-190.8-85.6-190.8-190.8s85.6-190.8 190.8-190.8c105.2 0 190.8 85.6 190.8 190.8 0 38.2-11.4 75.2-33 107l-0.4 0.6 0.5 5.3 78.5 78.5c6 6 9.3 14 9.3 22.5s-3.4 16.5-9.4 22.5c-5.9 6-13.9 9.3-22.4 9.3zM703.4 587c-70.1 0-127.2 57.1-127.2 127.2s57.1 127.2 127.2 127.2 127.2-57.1 127.2-127.2S773.6 587 703.4 587z"})]),z("div",void 0,{class:"egg_schedule_list_none_text"},j("暂无定时任务"))]))}function me({scheduleList:e,show:t}){let n="",i=F(-1),a=F(-1);return z("div",void 0,{class:ie(t,(()=>"egg_schedule"+(t.value?" active":"")))},[ue.settings[x.REMOTE_PUSH]?z("div",void 0,{class:"egg_schedule_token_wrap"},[z("div",void 0,{class:"egg_schedule_token"},[z("div",void 0,{class:"egg_schedule_label"},j("我的 token")),z("input",void 0,{class:"egg_schedule_token_input",placeholder:"用户 token",maxlength:32,value:ue.pushToken,onfocus:e=>{e.target.classList.add("active");$(".egg_schedule_submit_btn_wrap")[0].classList.add("active")},onblur:e=>{const t=e.target,i=t.value.trim();/^[0-9a-z]{32}$/.test(i)?(n=i,t.value=i):n="",t.classList.remove("active"),setTimeout((()=>{$(".egg_schedule_submit_btn_wrap")[0].classList.remove("active"),t.value=ue.pushToken}),100)}})]),z("div",void 0,{class:"egg_schedule_submit_btn_wrap"},z("button",void 0,{class:"egg_schedule_submit_btn",onclick:()=>{be("用户 token 已保存!"),n!==ue.pushToken&&(ue.pushToken=n,GM_setValue("pushToken",n))}},j("保存")))]):void 0,ue.settings[x.SCHEDULE_RUN]?z("div",void 0,{class:"egg_schedule_add"},[z("div",void 0,{class:"egg_schedule_time_wrap"},[z("div",void 0,{class:"egg_schedule_time"},[z("div",void 0,{class:"egg_schedule_label"},j("设置时间")),z("div",void 0,{class:"egg_schedule_time_input_wrap"},[fe({hour:i,minute:a}),z("button",void 0,{class:"egg_schedule_add_btn",onclick:()=>{if(!ue.settings[x.SCHEDULE_RUN])return void be("未开启定时刷新!");if(-1===i.value||-1===a.value)return void be("时间格式不符合要求!");if(e.find((e=>e.hour===i.value&&e.minute===a.value)))return void be("设置定时任务重复!");be("设置定时任务成功!"),e.push({hour:i.value,minute:a.value,time:`${ce(i.value)}:${ce(a.value)}`}),e.sort(((e,t)=>e.hour===t.hour?e.minute-t.minute:e.hour-t.hour)),GM_setValue("scheduleList",JSON.stringify(e)),i.value=-1,a.value=-1;$(".egg_time_input input").forEach((e=>e.value=""));const t=$(".egg_schedule_list")[0],n=$(".egg_schedule_add")[0];t.remove(),n.append(ve({scheduleList:e})),Te()}},N("svg",void 0,{viewBox:"0 0 1024 1024",class:"egg_icon"},N("path",void 0,{d:"M801.171 483.589H544V226.418c0-17.673-14.327-32-32-32s-32 14.327-32 32v257.171H222.83c-17.673 0-32 14.327-32 32s14.327 32 32 32H480v257.17c0 17.673 14.327 32 32 32s32-14.327 32-32v-257.17h257.171c17.673 0 32-14.327 32-32s-14.327-32-32-32z"})))])])]),ve({scheduleList:e})]):void 0])}function we({title:e,tip:t,checked:n,onChange:i}){return z("div",void 0,{class:"egg_setting_item"},[z("div",void 0,{class:"egg_label_wrap"},[z("label",void 0,{class:"egg_task_title"},[j(e),z("span",void 0,{class:"egg_detail",title:t},j("i"))])]),z("input",void 0,{title:t,class:"egg_switch",type:"checkbox",checked:n,onChange:i})])}function be(e,t=2,n){const i=$(".egg_tip_wrap")[0],a=$(".egg_tip");a.length&&a.forEach((e=>e.destroy()));const s=F(t),o=F(e),r=z("span",void 0,{class:"egg_countdown"},j(ie(s,(()=>`${s.value}s`)))),c=z("span",void 0,{class:"egg_text"},j(o));let l=!1,d=!1;const g=async()=>{if(n&&await n(s.value,_),!s.value)return d=!0,void _.hide();s.value--,setTimeout(g,1e3)},u=F(!1),p=z("div",void 0,{class:ie(u,(()=>"egg_tip"+(u.value?" active":"")))},[c,r]),_={async destroy(){l||(_.hide(),l=!0,setTimeout((()=>{p.remove()}),300))},hide(){l||(u.value=!1)},show(){l||(u.value=!0)},setText(e){o.value=e},waitCountDown:()=>new Promise((e=>{const t=setInterval((()=>{d&&(clearInterval(t),e(!0))}),100)}))};return Object.assign(p,_),i.append(p),_.show(),g(),_}async function ye(e,t){const n=$(".egg_frame_wrap")[0];if(n){$(".egg_frame_title",n)[0];const a=$(".egg_frame",n)[0],s=function(e=6){const t=[],n=[se,oe,re];if(e)for(let i=0;i<e;i++){const e=~~(Math.random()*n.length);t.push(n[e]())}return t.join("")}(10);return ue.closed=!1,ue.frameTile.value=t||"",a.src=e,await(i=a,new Promise((e=>{i.addEventListener("load",(()=>{e(!0)}))}))),a.contentWindow?.postMessage({id:s,closed:!1},e),{id:s,frame:a}}var i}function xe(){const e=$(".egg_frame_wrap")[0],t=$(".egg_frame_show_btn")[0];if(ue.frameShow.value=!1,e&&t){$(".egg_frame_title",e)[0];const t=$(".egg_frame",e)[0];ue.closed=!0,ue.frameTile.value="",t.src=""}}function ke(e){ue.settings[x.SAME_TAB]?window.parent.postMessage({id:e,closed:!0},u.homeOrigin):function(){try{window.opener=window,window.open("","_self")?.close(),top?.close()}catch(e){}}()}async function Ee(e,t){if(ue.settings[x.SAME_TAB]){ue.frameExist.value=!0,ue.frameShow.value=!ue.settings[x.SILENT_RUN];const n=await ye(e,t);if(n){const{id:e}=n;await function(e){return new Promise((t=>{window.addEventListener("message",(n=>{const{data:i}=n;i.id===e&&i.closed&&t(!0)})),setInterval((()=>{ue.closed&&t(!0)}),100)}))}(e)}}else{const t=function(e){return GM_openInTab(e,{active:!0,insert:!0,setParent:!0})}(e);await function(e){return new Promise((t=>{const n=setInterval((()=>{e.closed&&(clearInterval(n),t("done"))}),1e3)}))}(t)}}async function Te(){if(clearInterval(ue.scheduleTimer),!ue.login){const e=ue.scheduleList.filter((e=>!de(e)));if(e.length){const t=e[0];I(`已设置 ${t.time} 的定时任务!`),be(`已设置 ${t.time} 的定时任务!`);let n=0;const i=10;ue.scheduleTimer=setInterval((()=>{n++%i||I("定时刷新正在运行..."),function({hour:e,minute:t}){const n=new Date,i=n.getHours(),a=n.getMinutes(),s=n.getSeconds();return i===e&&a===t&&0===s}(t)&&(clearInterval(ue.scheduleTimer),I(`执行 ${t.time} 的定时任务!`),be(`执行 ${t.time} 的定时任务!`),Ce())}),1e3)}}}async function Se(){I("生成登录二维码!");const e=await async function(){try{const e=await fetch(g.generateQRCode,{method:"GET",mode:"cors"});if(e.ok){const t=await e.json();if(t.success)return t.result}}catch(e){}}();if(e){const t=`https://login.xuexi.cn/login/qrcommit?showmenu=false&code=${e}&appId=dingoankubyrfkttorhpou`;return{code:e,src:`${g.qrcode}?data=${encodeURIComponent(t)}`,url:t}}}async function Ae(e){I("尝试用二维码登录...");const t=await async function(e){try{const t=new URLSearchParams({qrCode:e,goto:"https://oa.xuexi.cn",pdmToken:""}),n=await fetch(g.loginWithQRCode,{method:"POST",mode:"cors",credentials:"include",headers:{"Content-Type":"application/x-www-form-urlencoded;charset=UTF-8"},body:t.toString()});if(n.ok)return await n.json()}catch(e){}}(e);if(t){const{data:e,code:n,success:i}=t;if("11019"===n)return;if(i&&e)return e}return S(1e3),Ae(e)}async function Me(e,t){I("正在获取签名...");const n=await async function(){try{const e=await fetch(g.sign,{method:"GET",mode:"cors",credentials:"include"});if(e.ok){const t=await e.json();if(t.ok)return t.data.sign}}catch(e){}}();if(n){const e=crypto.randomUUID(),[,i]=t.split("="),a=`${n}${e}`;return await async function(e){try{const t=new URLSearchParams(e),n=`${g.secureCheck}?${t}`,i=await fetch(n,{method:"GET",mode:"cors",credentials:"include"});if(i.ok)return(await i.json()).success}catch(e){}return!1}({code:i,state:a})}}async function Ce(){if(clearInterval(ue.refreshTimer),ue.refreshCount>=h){if(be("超过最大重试次数, 登录失败!"),ue.refreshCount=0,ue.startLogin.value=!1,ue.settings[x.REMOTE_PUSH]){be(`登录推送${await L({title:"登录推送",content:"超过最大重试次数, 登录失败!",type:"fail"},ue.pushToken)?"成功":"失败"}!`)}return}const e=$(".egg_login_img_wrap")[0],t=$(".egg_login_img_wrap .egg_login_img")[0];if(e&&t){I("刷新登录二维码!"),ue.refreshCount++;const e=await Se();if(e){const{src:n,code:i,url:a}=e;if(t.src=n,ue.startLogin.value=!0,ue.settings[x.REMOTE_PUSH]){const e=function(e){return`\n     <div style="padding: 10px 0">\n     <div\n       style="\n         display: flex;\n         justify-content: center;\n         align-items: center;\n         padding: 20px;\n         background: #f7f7f7;\n         border-radius: 10px;\n       "\n     >\n         <img src="${e}" style="width:200px;height:200px;" />\n       </div>\n     </div>\n`}(n),t=`\n   <div>\n      或在浏览器\n      <a\n        href="dtxuexi://appclient/page/study_feeds?url=${encodeURIComponent(a)}"\n        style="text-decoration: none"\n        >${R("打开学习强国APP")}</a\n      >\n    </div>\n  `;be(`登录推送${await L({title:"登录推送",content:["扫一扫, 登录学习强国!",t,e],type:"info"},ue.pushToken)?"成功":"失败"}!`)}const s=await Ae(i);if(s){if(await Me(0,s)){I("登录成功!");const e=await be("登录成功, 即将刷新页面!",5);if(await e.waitCountDown(),ue.settings[x.REMOTE_PUSH]){be(`登录推送${await L({title:"登录推送",content:"学习强国, 登录成功!",type:"success"},ue.pushToken)?"成功":"失败"}!`)}window.location.reload()}return}I("登录二维码失效!"),Ce()}}}function Re(){Ce(),ue.refreshTimer=setInterval((()=>{Ce()}),f)}async function Pe(){I("加载分数...");const e=await async function(){try{const e=await fetch(g.totalScore,{method:"GET",credentials:"include"});if(e.ok){const{data:t}=await e.json(),{score:n}=t;return n}}catch(e){}}(),t=await async function(){try{const e=await fetch(g.todayScore,{method:"GET",credentials:"include"});if(e.ok){const{data:t}=await e.json(),{score:n}=t;return n}}catch(e){}}();Number.isInteger(e)&&Number.isInteger(t)&&(ue.totalScore.value=e,ue.todayScore.value=t)}async function Le(){I("加载任务进度...");const e=await async function(){try{const e=await fetch(g.taskList,{method:"GET",credentials:"include"});if(e.ok){const{data:t}=await e.json(),{taskProgress:n}=t;return n}}catch(e){}}();if(e){ue.tasks[y.READ].currentScore=e[0].currentScore,ue.tasks[y.READ].dayMaxScore=e[0].dayMaxScore,ue.tasks[y.READ].need=e[0].dayMaxScore-e[0].currentScore,ue.tasks[y.WATCH].currentScore=e[1].currentScore+e[2].currentScore,ue.tasks[y.WATCH].dayMaxScore=e[1].dayMaxScore+e[2].dayMaxScore,ue.tasks[y.WATCH].need=e[1].dayMaxScore+e[2].dayMaxScore-(e[1].currentScore+e[2].currentScore),ue.tasks[y.PRACTICE].currentScore=e[5].currentScore,ue.tasks[y.PRACTICE].dayMaxScore=e[5].dayMaxScore,ue.tasks[y.PRACTICE].need=e[5].dayMaxScore-e[5].currentScore,ue.tasks[y.PAPER].currentScore=e[4].currentScore,ue.tasks[y.PAPER].dayMaxScore=e[4].dayMaxScore,ue.tasks[y.PAPER].need=e[4].dayMaxScore-e[4].currentScore;for(const e in ue.tasks){const{currentScore:t,dayMaxScore:n}=ue.tasks[e];let i=Number((100*t/n).toFixed(2));n<=t&&(i=100,ue.tasks[e].status=!0),ue.tasks[e].percent.value=i,ue.tasks[e].score.value=t}}else await S(2e3),await Le()}async function Ie(e){let t;if(0===e&&(t=1+~~(20*Math.random()+80)),1===e){const e=~~$("video")[0].duration;t=(e>120?120:e)+(10+~~(10*Math.random()))}const n=t-(4+~~(4*Math.random())),i=8+~~(4*Math.random()),a=unsafeWindow,s=be("距离关闭页面还剩",t,(async e=>{if(await M(),e===n){a.scrollTo(0,400);const e=new Event("scroll",{bubbles:!0});document.dispatchEvent(e);const t=new MouseEvent("mousemove",{bubbles:!0});document.dispatchEvent(t);const n=new Event("click",{bubbles:!0});document.dispatchEvent(n)}if(e===i){const e=document.body.scrollHeight/2;a.scrollTo(0,e);const t=new Event("scroll",{bubbles:!0});document.dispatchEvent(t);const n=new MouseEvent("mousemove",{bubbles:!0});document.dispatchEvent(n);const i=new Event("click",{bubbles:!0});document.dispatchEvent(i)}}));await s.waitCountDown(),ke(ue.id)}function ze(){return new Promise((async e=>{const t=ue.tasks[y.READ].need<p?ue.tasks[y.READ].need:p;I(`剩余 ${t} 个新闻`);const n=await async function(){const e=~~(Math.random()*g.todayNews.length);try{const t=await fetch(g.todayNews[e],{method:"GET"});if(t.ok)return await t.json()}catch(e){}}();if(n&&n.length)for(;ue.news.length<t;){const e=n[~~(Math.random()*n.length)];e.dataValid&&"tuwen"===e.type&&ue.news.push(e)}else ue.news=[];e("done")}))}function Ne(){return new Promise((async e=>{const t=ue.tasks[y.WATCH].need<_?ue.tasks[y.WATCH].need:_;I(`剩余 ${t} 个视频`);const n=await async function(){const e=~~(Math.random()*g.todayVideos.length);try{const t=await fetch(g.todayVideos[e],{method:"GET"});if(t.ok)return await t.json()}catch(e){}}();if(n&&n.length)for(;ue.videos.length<t;){const e=n[~~(Math.random()*n.length)];!e.dataValid||"shipin"!==e.type&&"juji"!==e.type||ue.videos.push(e)}else ue.videos=[];e("done")}))}async function je(){await ze();for(const e in ue.news){await M(),I(`正在阅读第 ${Number(e)+1} 个新闻...`),be(`正在阅读第 ${Number(e)+1} 个新闻`);const{url:t}=ue.news[e];if(GM_setValue("readingUrl",t),await Ee(t,"文章选读"),GM_setValue("readingUrl",null),be(`完成阅读第 ${Number(e)+1} 个新闻!`),await S(1500),await Pe(),await Le(),ue.settings[x.READ]&&ue.tasks[y.READ].status)break}ue.settings[x.READ]&&!ue.tasks[y.READ].status&&(I("任务未完成, 继续阅读新闻!"),be("任务未完成, 继续阅读新闻!"),await je())}async function $e(){await Ne();for(const e in ue.videos){await M(),I(`正在观看第 ${Number(e)+1} 个视频...`),be(`正在观看第 ${Number(e)+1} 个视频`);const{url:t}=ue.videos[e];if(GM_setValue("watchingUrl",t),await Ee(t,"视听学习"),GM_setValue("watchingUrl",null),be(`完成观看第 ${Number(e)+1} 个视频!`),await S(1500),await Pe(),await Le(),ue.settings[x.WATCH]&&ue.tasks[y.WATCH].status)break}ue.settings[x.WATCH]&&!ue.tasks[y.WATCH].status&&(I("任务未完成, 继续观看视频!"),be("任务未完成, 继续观看看视频!"),await $e())}var Ue;function He(){return new Promise((e=>{const t=setInterval((()=>{const n=$(".ant-btn").filter((e=>e.innerText));if(n.length){if(clearInterval(t),2===n.length)return void e(n[1]);e(n[0])}}),500)}))}function De(){return new Promise((async e=>{const t=$("#nc_mask")[0];if(t&&"none"!==getComputedStyle(t).display){be("等待滑动验证"),t.style.zIndex="999";const n=$(".nc_scale")[0],i=$(".btn_slide")[0],a=n.getBoundingClientRect(),s=i.getBoundingClientRect(),o=unsafeWindow,r=function(e,t,n){const i=(t.x-e.x)/n,a=(t.y-e.y)/n,s=[];s.push(e);for(let e=0;e<n;e++){const t=s[e].x+5*Math.random()+i,n=s[e].y+5*Math.random()*Math.pow(-1,~~(2*Math.random()+1))+a;s.push({x:t,y:n})}return s}(function(e){const{x:t,y:n,width:i,height:a}=e;return{x:t+Math.random()*i*.5+.25*i,y:n+Math.random()*a*.5+.25*a}}(s),{x:a.x+a.width,y:a.y+a.height/2},10);if(T()){i.style.touchAction="none";const e=[new Touch({identifier:0,target:i,clientX:r[0].x,clientY:r[0].y})],t=new TouchEvent("touchstart",{targetTouches:e,touches:e,changedTouches:e,view:o,bubbles:!0});i.dispatchEvent(t);for(const e in r){const t=[new Touch({identifier:0,target:i,clientX:r[e].x,clientY:r[e].y})],n=new TouchEvent("touchmove",{targetTouches:t,touches:t,changedTouches:t,view:o,bubbles:!0});i.dispatchEvent(n),await S(10)}const n=new Touch({identifier:0,target:i,clientX:r[r.length-1].x,clientY:r[r.length-1].y}),a=new TouchEvent("touchend",{targetTouches:[],touches:[],changedTouches:[n],view:o,bubbles:!0});i.dispatchEvent(a)}else{const e=new MouseEvent("mousedown",{clientX:r[0].x,clientY:r[0].y,bubbles:!0,view:o});i.dispatchEvent(e);for(const e in r){const t=new MouseEvent("mousemove",{clientX:r[e].x,clientY:r[e].y,bubbles:!0,view:o});i.dispatchEvent(t),await S(10)}const t=new MouseEvent("mouseup",{clientX:r[r.length-1].x,clientY:r[r.length-1].y,bubbles:!0,view:o});i.dispatchEvent(t)}be("滑动验证完成!");const c=setInterval((()=>{const t=$("#nc_mask")[0];if(!t||"none"===getComputedStyle(t).display)return I("滑动验证成功!"),be("滑动验证成功!"),clearInterval(c),void e(!0);e(!1),I("滑动验证失败!"),be("滑动验证失败!")}),1e3)}else e(!0)}))}function Oe(e){const t=$(".q-answer");return!(!e.length||!t.length)&&e.every((e=>{if(e&&e.length){let n;if(t.forEach((t=>{const i=t.innerText.trim(),a=i.replaceAll(/[、，,。 ]/g,""),s=e.replaceAll(/[、，,。 ]/g,"");(i===e||i.includes(e)||e.includes(i)||a.includes(s))&&(n?n.innerText.length>i.length&&(n=t):n=t)})),n)return n.classList.contains("chosen")||n.click(),!0}return!1}))}function Ve(){const e=$(".q-answer");if(e.length){const t=e[~~(Math.random()*e.length)];t.classList.contains("chosen")||t.click()}}function Ge(){const e=$(".q-answer");e.length&&e.forEach((e=>{e.classList.contains("chosen")||e.click()}))}!function(e){e[e.PRACTICE=0]="PRACTICE",e[e.PAPER=1]="PAPER"}(Ue||(Ue={}));const Be=e=>{const t=$(".blank");if(t.length&&e.length){if(e.length===t.length)return e.every(((e,n)=>{if(e&&e.length){const i=new Event("input",{bubbles:!0});return t[n].setAttribute("value",e),t[n].dispatchEvent(i),!0}return!1}));if(1===t.length&&e.length>1){const n=e.join("");if(n&&n.length){const e=new Event("input",{bubbles:!0});return t[0].setAttribute("value",n),t[0].dispatchEvent(e),!0}}}return!1};async function We(){const e=$(".blank");if(e.length){const t=new Event("input",{bubbles:!0});e.forEach((e=>{e.setAttribute("value","答案"),e.dispatchEvent(t)}))}}async function qe(e){let t,n,i=!1;for(;;){await S(2500),await A(),t=await He(),n=t.innerText.replaceAll(" ","");if(["再练一次","再来一组","查看解析"].includes(t.innerText))break;$(".tips")[0]?.click();const a=$(".line-feed font[color]").map((e=>e.innerText.trim())),s=$(".q-body")[0].innerText;await S(1500),await A();const o=$(".q-answer"),r=$("input[type=text][class=blank]"),c=$(".q-header")[0].innerText.substring(0,3);switch(await A(),c){case"填空题":{if(a.length){if(Be(a))break}be("答案异常, 尝试网络题库获取!");const t=await w(s);if(t.length){if(Be(t))break}if(e===Ue.PRACTICE||ue.settings[x.RANDOM_EXAM])I("答案不存在, 随机作答!"),be("答案不存在, 随机作答!"),await We();else{be(`学习推送${await L({title:"学习推送",content:"答题存在异常, 已暂停答题!",type:"fail"},ue.pushToken)?"成功":"失败"}!`),ue.examPause.value=!0,i=!0}break}case"多选题":{if(a.length){const e=o.map((e=>e.innerText)).map((e=>e.split(/[A-Z]./)[1].trim())).join(""),t=s.match(/（）/g);if(t&&o.length===t.length||s===e||2===o.length){o.forEach((e=>{e.classList.contains("chosen")||e.click()}));break}if(o.length>=a.length){if(Oe(a))break}}be("答案异常, 尝试网络题库获取!");const t=await w(s);if(t.length){if(Oe(t))break}if(e===Ue.PRACTICE||ue.settings[x.RANDOM_EXAM])I("答案不存在, 随机作答!"),be("答案不存在, 随机作答!"),await Ge();else{be(`学习推送${await L({title:"学习推送",content:"答题存在异常, 已暂停答题!",type:"fail"},ue.pushToken)?"成功":"失败"}!`),ue.examPause.value=!0,i=!0}break}case"单选题":{if(a.length)if(1===a.length){if(Oe(a))break}else{const e=[""," ",",",";",",","、","-","|","+","/"].map((e=>a.join(e)));if(e.every((e=>e.length))){if(e.some((e=>Oe([e]))))break}}be("答案异常, 尝试网络题库获取!");const t=await w(s);if(t.length)if(1===t.length){if(Oe(t))break}else{const e=[""," "].map((e=>a.join(e)));if(e.every((e=>e.length))){if(e.some((e=>Oe([e]))))break}}if(e===Ue.PRACTICE||ue.settings[x.RANDOM_EXAM])I("答案不存在, 随机作答!"),be("答案不存在, 随机作答!"),await Ve();else{be(`学习推送${await L({title:"学习推送",content:"答题存在异常, 已暂停答题!",type:"fail"},ue.pushToken)?"成功":"失败"}!`),ue.examPause.value=!0,i=!0}break}}if(await A(),t=await He(),n=t.innerText.replaceAll(" ",""),i){const e=md5(s),t=[];"填空题"===c&&r.forEach((e=>{t.push(e.value)})),"单选题"!==c&&"多选题"!==c||o.forEach((e=>{if(e.classList.contains("chosen")){const n=e.innerText,[,i]=n.split(".");i&&i.length&&t.push(i)}}));const n=t.join(";");n.length&&(I("上传答案",{answer:n,key:e,question:s}),await b(e,n),I("上传答案成功!")),i=!1}if("确定"===n){t.click(),await S(2e3),await A();const e=$(".answer")[0];if(e){const t=md5(s),n=e.innerText,[,i]=n.split("：");if(i&&i.length){const e=i.replaceAll(" ",";");I("上传答案",{answer:e,key:t,question:s}),await b(t,e)}}await De()}t=await He(),n=t.innerText.replaceAll(" ",""),"下一题"!==n&&"完成"!==n&&"交卷"!==n||(await S(2500),t.click())}ke(ue.id)}async function Fe(){await M(),I("正在做每日答题..."),be("正在做每日答题");const e=u.examPractice;await Ee(e,"每日答题"),be("完成每日答题!"),await S(1500),await Pe(),await Le(),ue.settings[x.PRACTICE]&&!ue.tasks[y.PRACTICE].status&&(I("任务未完成, 继续每日答题!"),be("任务未完成, 继续每日答题!"),await Fe())}async function Xe(){be("正在寻找未做的专项练习");const e=await async function(){I("正在寻找未完成的专项练习...");const e=await async function(){const e=await m(1);if(e)return await S(3e3),e.totalPageCount}();let t=e;I("专项练习, 开启逆序模式, 从最早的题目开始答题"),I("正在寻找未完成的专项练习...");for(;t<=e&&t;){const e=await m(t);if(!e)break;{const n=e.list;n.reverse();for(const e in n)if(1===n[e].status)return n[e].id;t+=-1,await S(3e3)}}}();if(e){await M(),I("正在做专项练习..."),be("正在做专项练习");const t=`${u.examPaper}?id=${e}`;return I(`链接: ${t}`),await Ee(t,"专项练习"),be("完成专项练习!"),await S(1500),await Pe(),await Le(),void(ue.settings[x.PAPER]&&!ue.tasks[y.PAPER].status&&(I("任务未完成, 继续专项练习!"),be("任务未完成, 继续专项练习!"),Xe()))}be("专项练习均已完成!")}
